<!DOCTYPE html>
<html lang="en" prefix="og: https://ogp.me/ns#">
  <head>
    <meta charset="UTF-8" />
    <link rel="icon" type="image/png" href="/lovable-uploads/5c3a0a2c-ab7e-49e8-ab39-c9e3770cc0e7.png" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0" />
    
    <!-- SEO meta tags are injected per-page by the SEOHead component during SSG -->
    
    <!-- Google Search Console Verification -->
    <!-- Add your verification meta tag here after setting up GSC -->
    <!-- <meta name="google-site-verification" content="YOUR_VERIFICATION_CODE" /> -->
    
    <!-- Preload critical hero image for faster LCP -->
    <link rel="preload" as="image" href="https://images.unsplash.com/photo-1611374243463-cc5b113d5f20?q=80&w=2070&auto=format&fit=crop">
    <meta name="theme-color" content="#2C4A3B">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <meta name="apple-mobile-web-app-title" content="MyBirdieBoard">
    <link rel="apple-touch-icon" href="/lovable-uploads/5c3a0a2c-ab7e-49e8-ab39-c9e3770cc0e7.png">
    <link rel="manifest" href="/manifest.json">
    
    <!-- Preconnect to external resources for faster loading -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link rel="preconnect" href="https://images.unsplash.com">
    <link rel="dns-prefetch" href="https://images.unsplash.com">
    
    <!-- Font optimization with font-display: swap for better CLS -->
    <style>
      /* Critical CSS for above-the-fold content - prevents CLS */
      body { font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; }
      #root { min-height: 100vh; }
      /* Prevent layout shift from images */
      img { max-width: 100%; height: auto; }
    </style>
    
    <!-- Static Open Graph tags (page-specific tags injected by SSG onPageRendered hook) -->
    <meta property="og:site_name" content="MyBirdieBoard">
    <meta property="og:locale" content="en_US">
    <meta name="twitter:site" content="@mybirdieboard">
    <meta name="twitter:creator" content="@mybirdieboard">
    
    <!-- SEO meta tags -->
    <meta name="robots" content="index, follow, max-image-preview:large, max-snippet:-1, max-video-preview:-1">
    <meta name="googlebot" content="index, follow">
    <meta name="author" content="MyBirdieBoard">


    <!-- Organization structured data -->
    <script type="application/ld+json">
      {
        "@context": "https://schema.org",
        "@type": "Organization",
        "@id": "https://mybirdieboard.com/#organization",
        "name": "MyBirdieBoard",
        "url": "https://mybirdieboard.com",
        "logo": {
          "@type": "ImageObject",
          "url": "https://mybirdieboard.com/logo.png",
          "width": 512,
          "height": 512
        },
        "sameAs": [
          "https://twitter.com/mybirdieboard",
          "https://facebook.com/mybirdieboard"
        ],
        "contactPoint": {
          "@type": "ContactPoint",
          "contactType": "customer support",
          "url": "https://mybirdieboard.com/faq"
        }
      }
    </script>
    
    <!-- WebSite structured data -->
    <script type="application/ld+json">
      {
        "@context": "https://schema.org",
        "@type": "WebSite",
        "@id": "https://mybirdieboard.com/#website",
        "name": "MyBirdieBoard",
        "url": "https://mybirdieboard.com",
        "description": "Track golf scores, calculate your handicap, and improve your game with MyBirdieBoard.",
        "publisher": {
          "@id": "https://mybirdieboard.com/#organization"
        },
        "potentialAction": {
          "@type": "SearchAction",
          "target": {
            "@type": "EntryPoint",
            "urlTemplate": "https://mybirdieboard.com/courses?search={search_term_string}"
          },
          "query-input": "required name=search_term_string"
        }
      }
    </script>
    
    <!-- SoftwareApplication structured data -->
    <script type="application/ld+json">
      {
        "@context": "https://schema.org",
        "@type": "SoftwareApplication",
        "name": "MyBirdieBoard",
        "applicationCategory": "SportsApplication",
        "operatingSystem": "Web",
        "description": "Golf score tracking app with handicap calculator and performance analytics.",
        "offers": {
          "@type": "Offer",
          "price": "2.99",
          "priceCurrency": "GBP"
        }
      }
    </script>
  </head>
  <body>
    <div id="root"></div>
    <script>
      // Client-only routes served via SPA fallback get pre-rendered homepage HTML.
      // Clear it so React does a fresh render instead of a broken hydration.
      (function(){
        var p = location.pathname;
        var clientOnly = ['/dashboard','/admin','/checkout','/auth/'];
        for(var i=0;i<clientOnly.length;i++){
          if(p===clientOnly[i]||p.startsWith(clientOnly[i]+'/')||p.startsWith('/courses/')){
            document.getElementById('root').innerHTML='';
            break;
          }
        }
      })();

      // Global handler: catch stale-chunk errors that escape React error boundaries.
      // Auto-reload once to pick up fresh assets after a deploy.
      function handleChunkError(m) {
        if (
          m.indexOf('is not valid JSON') !== -1 ||
          m.indexOf("Unexpected token '<'") !== -1 ||
          m.indexOf('Failed to fetch dynamically imported module') !== -1 ||
          m.indexOf('Loading chunk') !== -1 ||
          m.indexOf('Loading CSS chunk') !== -1
        ) {
          var k = 'chunk_error_reload';
          var now = Date.now();
          var last = parseInt(sessionStorage.getItem(k) || '0', 10);
          // Allow a reload if last one was more than 10 seconds ago (prevents infinite loops but allows retries)
          if (!last || (now - last) > 10000) {
            sessionStorage.setItem(k, String(now));
            window.location.reload();
          }
        }
      }
      window.addEventListener('error', function(e) {
        handleChunkError(e && e.message || '');
      });
      // Dynamic import failures surface as unhandled promise rejections
      window.addEventListener('unhandledrejection', function(e) {
        var r = e && e.reason;
        handleChunkError(r && (r.message || String(r)) || '');
      });
      // Clear the reload guard on successful load so future deploys can trigger a fresh reload
      window.addEventListener('load', function() {
        sessionStorage.removeItem('chunk_error_reload');
      });
    </script>
    <script type="module" src="/src/main.tsx"></script>
  </body>
</html>
